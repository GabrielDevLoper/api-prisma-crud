# Migration `20200615172306-alter-table-product-and-category`

This migration has been generated by Gabriel Barreto at 6/15/2020, 5:23:06 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."Category_product_id"

ALTER TABLE "public"."Category" DROP CONSTRAINT IF EXiSTS "Category_product_id_fkey",
DROP COLUMN "product_id";

ALTER TABLE "public"."Product" ADD COLUMN "category_id" integer   ;

CREATE UNIQUE INDEX "Product_category_id" ON "public"."Product"("category_id")

ALTER TABLE "public"."Product" ADD FOREIGN KEY ("category_id")REFERENCES "public"."Category"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200615171211-alter-field-category-in-product..20200615172306-alter-table-product-and-category
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url      = "postgresql://postgres:postgres@localhost:5432/prisma-crud?schema=public"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -41,13 +41,13 @@
   name        String
   qtd         Int
   price       Float
   price_total Float
-  category    Category?
+  category_id Int?
+  category    Category? @relation(fields: [category_id], references: [id])
 }
 model Category {
-  id         Int      @id @default(autoincrement())
-  name       String
-  product_id Int?
-  product    Product? @relation(fields: [product_id], references: [id])
+  id      Int      @id @default(autoincrement())
+  name    String
+  product Product?
 }
```


